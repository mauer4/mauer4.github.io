{{/* Attention timeline shortcode
   Renders a vertical timeline from data/attention_plan.yaml
   Usage: {{< attention_timeline >}}
*/}}
{{ $plan := site.Data.attention_plan }}
<section class="attention-hero">
  <div class="container">
    <h1>{{ with $plan.title }}{{ . }}Attention From Scratch</h1>
    {{ with $plan.subtitle }}<p class="subtitle">{{ . }}</p>
    {{ $start := $plan.start_date }}
    <div class="meta-bar" role="group" aria-label="Plan dates">
      <div class="meta-chip">
        <span class="meta-emoji">ðŸ“…</span>
        <span class="meta-label">Today</span>
        <span class="meta-value">{{ now | time.Format "2006-01-02" }}</span>
      </div>
      <div class="meta-chip">
        <span class="meta-emoji">ðŸš€</span>
        <span class="meta-label">Start</span>
        <span class="meta-value">{{ with $start }}{{ . }}TBD</span>
      </div>
      <div class="meta-chip">
        <span class="meta-emoji">ðŸ”„</span>
        <span class="meta-label">Updated</span>
        <span class="meta-value">{{ site.Lastmod | time.Format "2006-01-02" }}</span>
      </div>
    </div>
    {{/* Progress bar */}}
    {{ $total := len $plan.weeks }}
    {{ $completed := len (where $plan.weeks "completed" true) }}
    {{ $pct := div (mul $completed 100) $total }}
      <div class="progress">
        <div class="progress-label">Progress: {{ $completed }}/{{ $total }} ({{ $pct }}%)</div>
        <div class="progress-outer" aria-label="Plan progress" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="{{ $pct }}">
          <div class="progress-inner" style="width: {{ $pct }}%"></div>
        </div>
      </div>
  </div>
</section>

<section class="attention-timeline">
  <div class="timeline-wrapper">
    <div class="timeline-list">
      {{ range $plan.weeks }}
      {{ $title := .title | lower }}
      {{ $isAttn := or (in $title "attent") (in $title "kv") }}
      <div class="timeline-item" data-id="{{ .id }}" data-week="{{ .week }}" data-title="{{ .title }}" data-target="{{ .target_date }}" data-completed="{{ .completed }}">
        <div class="dot {{ if .completed }}completed" title="{{ if .completed }}CompletedPlanned">
        </div>
        <div class="content" tabindex="0" role="button" aria-label="Open details for week {{ .week }}" title="Click for details and checklist (Enter to open)">
          <div class="header">
            <div class="left">
              <div class="week">Week {{ .week }}</div>
              <div class="title"><span>{{ .title }}</span></div>
            </div>
            <div class="right">
              {{ with .target_date }}<div class="target">Target: {{ . }}</div>
              {{ if .completed }}{{ with .completed_date }}<div class="done">Done: {{ . }}</div>
            </div>
          </div>
          <div class="summary">{{ .summary }}</div>
          <div class="cta-row" aria-hidden="true"><span class="cta-text">View details & checklist</span><span class="cta-chev">â†—</span></div>
          <div class="overlay-template" hidden>
            <div class="overlay-header">
              <div class="overlay-week">Week {{ .week }}</div>
              <div class="overlay-title">{{ .title }}</div>
              {{ with .target_date }}<div class="overlay-target">Target: {{ . }}</div>
            </div>
            <div class="overlay-body">
              <p>{{ .details }}</p>
              {{ if .checklist }}
              <div class="overlay-checklist">
                <div class="checklist-title">Checklist</div>
                <ul>
                  {{ range .checklist }}
                    <li><input type="checkbox" disabled /> <span>{{ . }}</span></li>
                </ul>
              </div>
              {{ with .comments }}
              <div class="overlay-notes">
                <div class="notes-title">Notes</div>
                <ul>
                  {{ range . }}<li>{{ . }}</li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<div class="attention-overlay" hidden aria-hidden="true">
  <div class="overlay-backdrop"></div>
  <div class="overlay-panel" role="dialog" aria-modal="true" aria-label="Week details">
    <button class="overlay-close" aria-label="Close">âœ•</button>
    <div class="overlay-content">
      <!-- Injected dynamically -->
    </div>
  </div>
</div>

{{ $js := resources.Get "js/attention.js" | resources.Minify | resources.Fingerprint }}
<script defer src="{{ $js.RelPermalink }}"></script>


